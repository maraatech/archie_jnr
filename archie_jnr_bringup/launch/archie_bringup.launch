<?xml version="1.0" ?>
<launch>
	<!-- Default namespace topics: DO NOT EDIT -->
	<arg name="ns_a" value="a"/>
	<arg name="ns_b" value="b"/>
	
	<!-- Load robot description -->
	<include file="$(find archie_jnr_bringup)/launch/load_archie.launch" pass_all_args="true">
		<arg name="ee_sensor_a" value=""/><!--stereo realsense zivid kea stereo-kea -->
  		<arg name="ee_sensor_b" value="stereo"/><!--stereo realsense zivid kea stereo-kea -->
  	</include>

  	<!-- Load UR arm on local machine -->
  	<include file="$(find archie_jnr_bringup)/launch/archie_side_bringup.launch">
  		<arg name="ns"        		   value="$(arg ns_a)"/>

		<arg name="robot_ip"           value="192.168.131.9"/>
		<arg name="reverse_port"       value="50001"/>
		<arg name="script_sender_port" value="50002"/>
  	</include>

  	<!-- Start joint_state aggregator -->
  	<node name="joint_state_publisher" pkg="joint_state_publisher" type="joint_state_publisher">
      <param name="/use_gui" value="false"/>
      <rosparam param="/source_list">[a/joint_states, b/joint_states]</rosparam>
    </node>

    <!-- State publishers -->
	<node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher" respawn="true" output="screen" />

	<!-- Launch moveit -->
	<arg name="debug" default="false" />
	<include file="$(find archie_jnr_moveit_config)/launch/move_group.launch">
		<arg name="debug" default="$(arg debug)" />
		<arg name="publish_monitored_planning_scene" value="true" />
		<arg name="load_robot_description" value="false" />
	</include>

	<!-- Launch rviz -->
	<node type="rviz" name="rviz_archie" pkg="rviz" args="-d $(find archie_jnr_bringup)/rviz/archie.rviz" />

	<!-- load UR arm on secondary machine -->
	<!-- NOTE: anything after the machine tag is run on the remote machine - hence this being at the bottom of the launch file -->
	<!-- <machine name="side-$(arg ns_b)" user="anyone" address="stormtrooper" env-loader="~/archie-environment.sh" default="true"/> -->
	<include file="$(find archie_jnr_bringup)/launch/archie_side_bringup.launch">
  		<arg name="ns"        		   value="$(arg ns_b)"/>

  		<arg name="robot_ip"           value="192.168.131.8"/>
  		<arg name="reverse_port"       value="50003"/>
		<arg name="script_sender_port" value="50004"/>

		<!-- Testing at UoA with UR10 -->
		<arg name="kinematics_config"  value="$(find archie_jnr_description)/config/$(arg ns_b)/ur10_calibration.yaml"/>
		<arg name="joint_limit_params" value="$(find archie_jnr_description)/config/$(arg ns_b)/joint_limits.yaml"/>
  	</include>
</launch>

<!-- <machine name="side-$(arg ns_a)" user="anyone" address="kylo-ren" env-loader="~/archie-environment.sh" default="true"/> -->
<!-- <machine name="side-$(arg ns_b)" user="anyone" address="stormtrooper" env-loader="~/archie-environment.sh" default="true"/> -->